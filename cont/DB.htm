<html>
<head><meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
<title>Диалоговые окна</title>
<LINK REL="stylesheet" MEDIA="screen" TYPE="text/css" HREF="../style.css">
</head>
<body><h2 align="center">Диалоговые окна (ресивер <a href="../Rec/IF.htm">IF</a>)</h2>
<p>Если вам нужно показать игроку сообщение, задать вопрос, показать картинку или 
анимацию игроку, или дать игроку выбрать между опциями, или дать напечатать 
что-либо (например, своё имя), вы должны использовать диалоговые окна.</p>
<h3>Типы диалоговых окон</h3>
<p>Есть два основных типа диалоговых окон, которые могут быть показаны с помощью 
ERM. Первый - стандартный диалог, который вы регулярно видели в оригинальных 
Героях. Второй - расширенный диалог, который используется для показа внешних 
картинок и анимаций, делают возможным ввод данных с клавиатуры и выбор из 
каких-либо опций. От вашего выбора будет зависеть тип информации, которую вы 
сможете показать. Вы можете использовать оба типа для показа только информации, 
или для показа картинки и вопроса к игроку, в конце концов, простой выбор между 
&quot;Да&quot; и &quot;Нет&quot; (Отмена). Стандартные диалоговые окна более просты в использовании, 
чем расширенные, которые требуют дополнительные команды.</p>
<h3>Использование стандартных диалоговых окон</h3>
<p>Они базируются всего лишь на двух командах для стандартного окна диалога: <a href="../Rec/IF.htm#M">IF:M</a>, 
который используется для одиночных сообщений, и <a href="../Rec/IF.htm#Q">IF:Q</a>, который используется для 
вопросов типа &quot;Да/Нет&quot; и для показа картинок. В обоих случаях, всё зависит 
только от вашего желания ;)</p>
<ul>
<li>Пример показа простого диалогового окна - сообщения командой <a href="../Rec/IF.htm#M">
IF:M</a> :
<a name="M"></a><script type="erm">!!IF:M^В этой загадочной стране летающие существа не летают, но им не отвечают на атаку.^;</script>
В этом коде будет показано сообщение, которое вы видите ниже, белым текстом, выровненное по центру. 
Ниже будет одна кнопка ОК, которую должен нажать игрок для продолжения игры.
<p align="center"><img src="../Img/if/IFM.jpg" width="319" height="191"></p></li>

<li>Пример показа простого окна вопроса командой <a href="../Rec/IF.htm#Q">IF:Q</a> (без картинки):
<a name="Q2"></a><script type="erm">!!IF:Q2^Особые правила модифицируют игру. Вы хотите выбрать их вручную? 
(Если нет, одна или две опции будут выбраны случайно.)^;</script>
В этом примере появится, как видно, диалоговое окно с двумя кнопками: ОК и Отмена.
Число 2 после IF:Q означает, что флаг 2 будет принимать значение выбранной кнопки, и установится на Ложь (0), если будет нажата Отмена.<br>
Для вопроса может быть выбран любой флаг. См. <a href="../Cont/Flags.htm">флаги и переменные</a> для дополнительной информации.
<p align="center"><img src="../Img/if/IFQ2.jpg" width="318" height="190"></p></li>

<li>Пример показа сообщения с картинкой (без вопроса):
<a name="Q+pic"></a><script type="erm">!!IF:Q2/20/53/1^{Гриб Магии Воды}
Гриб Магии Воды даёт навык Магия Воды эксперта до конца недели...
Вы вдыхаете споры гриба...
Вы стали Экспертом Магии Воды!^;</script>
<p align="center"><img src="../Img/if/IFQ1.jpg" width="312" height="376"></p></li>

<li>Пример показа сообщения и двух картинок - игрок должен нажать на картинку для её выбора и нажать кнопку ОК:
<a name="Q7+pic"></a></a><script type="erm">!!IF:Q2/5//8/141/7^Вы желаете сыграть на {ресурсы} или {артефакты}?^;</script>
<p align="center"><img src="../Img/if/IFQ4.jpg" width="317" height="318"></p></li>
</ul>

<p>Однако, есть и ещё один тип диалога, использующий стандартные ресурсы игры - это команда <a href="../Rec/IF.htm#N">IF:N</a>. 
Здесь может быть до 8 картинок одновременно, параметры показа которых такие же, как и для <a href="../Rec/IF.htm#Q">IF:Q</a>.
<a name="N"></a><script type="erm" class=list>!!HE-1:B0/?z2;	получить имя текущего героя в z2
!!VRz1:S^%Z2 учит особые заклинания...^;
!!IF:N9/10/9/11/9/12/9/13;
!!IF:N1/z1;</script>
<p align="center"><img src="../Img/if/IFN.jpg" width="502" height="246" style="border:1px solid #000"></p>
<p>Как видите, есть много комбинаций с этими командами ресивера <a href="../Rec/IF.htm">!!IF</a>. Экспериментируйте!</p>
<h3>Использование Расширенного диалогового окна #1 - многозадачный диалог</h3>
<p>Если вы хотите разрешить игроку ввести текст, позволить ему выбрать что-либо 
из четырех вариантов, и/или показать определённые картинки или анимации, вы 
должны использовать расширенные диалоговые окна. В общем, вам нужно записать 
некоторый текст в <i>z</i>-переменную и затем использовать её для установки команд в 
расширенном диалоговом окне. Для их установки воспользуйтесь командами
<a href="../Rec/IF.htm#D">IF:D</a> и <a href="../Rec/IF.htm#F">IF:F</a>, а 
для показа - командой <a href="../Rec/IF.htm#E">IF:E</a>. Любая опция ниже может 
быть соединена в многозадачный диалог:</p>
<p><b id="step">1. Показ картинок:</b> в отличии от стандартного диалогового окна, 
расширенное не может показывать внутренние, т.е. игровые, картинки, а только 
внешние картинки, с определённым типом и размером. Если вам нужно показать ещё и 
внутреннюю картинку игры, воспользуйтесь клавишей <span class="key">Print Screen</span> и вырежьте нужную 
картинку. Путь к картинке может содержать до 256 символов, и начинается с 
директории <i class="file">Heroes3\Maps</i>. Картинки могут быть BMP, GIF или JPG с максимальным 
размером 100х100 пикселей. Если изображение меньше, оно будет выровнено по 
центру свободного пространства. Если изображение больше, только 100х100 пикселей 
будет показано. Для BMP верхний левый пиксель будет интерпретироваться как 
прозрачный. Вы можете смешивать и менять картинки как захотите. Команда <a href="../Rec/IF.htm#D">
IF:D</a> используется для установки картинок для многозадачного диалогового окна.</p>
<u>Пример 1</u>:
<script type="erm">!!VRz10:S^Земли, в которых вы путешествуете, прекрасны.^;
!!VRz11:S^blue forest.jpg^;
!!VRz12:S^sparkling lake.bmp^;
!!VRz13:S^rainbow.gif^;
!!VRz14:S^mountains.jpg^;
!!VRz15:S^Мрачный лес^;
!!VRz16:S^Кристальное озеро^;
!!VRz17:S^Мистический дождь^;
!!VRz18:S^Туманные горы^;
!!IF:D5/10/0/0/11/12/13/14/15/16/17/18/0/0/0/0;
!!IF:E1/5;</script>
<p>В этом примере, в z10 записан заглавный текст для диалога, в 
z11..z14 записаны имена картинок в папке Maps, и в z15..z18 записаны подсказки 
для каждой картинки. Мы использовали диалоговое окно №5 (первый параметр), далее 
номер <i>z</i>-переменной, содержащей главный текст, далее два 0, означающие &quot;Не 
изменять эти параметры&quot;. После этого - <i>z</i>-переменные с именами файлов (11..14) и 
<i>z</i>-переменные для подсказок (15..18). Последние четыре параметры также не 
используются в этом примере и мы заменяем их нулями.</p>
<p><b id="step">2. Показ анимации:</b> вы можете использовать расширенный диалог для 
показа анимации или клипа в формате AVI. AVI-анимация может быть показана вместо 
картинки и может быть комбинирована с картинками (например, вы можете показать 
две анимации и две картинки в одном диалоге). Работает 
AVI как раз несжатая,&nbsp; или сжатая плохо (RLE, например). 
Большинство компрессий, в том числе DivX и XviD, приводят к ошибке <i class="file">zvslib1.dll</i>. 
Это, кстати, затрудняет использование AVI в дополнениях, потому как даже 
короткая AVI-uncompressed занимаем мегабайты.<br>
Отличия проигрывания GIF от AVI в wog-диалогах:
<ul><li>AVI стабильно проигрывается, не исходя полосками, в отличие от GiF.</li>
<li>С другой стороны, в формате IF:D, когда в диалоге нет пунктов выбора 
($12..$15), GIF не вылазит за пределы диалога, в отличие от AVI.</li></ul>
Как и картинки, анимация ограничена 100х100 
пикселей. Опять же, используйте <a href="../Rec/IF.htm#D">IF:D</a> для установки анимации для расширенного 
диалогового окна.</p>
<p><b id="step">3. Чекбоксы:</b> если вы хотите дать игроку выбор между четырьмя (или 
более) опциями, вы можете использовать чекбоксы. Там вы можете ввести заголовок 
сообщения (текст будет жёлтым). Каждая опция чекбокса будет иметь текст в 
табличке, и также может иметь текст-подсказку (показывается внизу диалогового 
окна при наведении курсора на опцию). И хотя вы не можете поместить картинку в 
сам чекбокс, вы можете соотнести выбранную опцию и картинку в ней, которая будет 
показана выше. Когда диалог появится, ни одна опция не будет выбрана. Игрок 
может выбрать только одну опцию, выбор другой автоматически отключит предыдущую. 
После нажатия игрока на ОК, вы можете проверить, какая опция была выбрана, её 
номер запоминается в <i>v</i>-переменную. Устанавливается диалог так же, как и картинки 
и анимации:
<a href="../Rec/IF.htm#D">IF:D</a> и <a href="../Rec/IF.htm#F">IF:F</a> для 
добавления текста-подсказок для чекбоксов, если захотите.</p>
<p><b id="step">4. Ввод текста:</b> если в хотите получить текстовое сообщение от игрока, 
вы можете показать окно ввода. Над ним вы можете ввести небольшое сообщение 
(текст будет жёлтым). Текст, введенный игроком в окно ввода, занесётся в 
текстовую переменную (<i>z</i>-переменную), и может быть использован для имени города 
или героя, текста-подсказки, текста знака, часть другого сообщения, или может 
быть проверена, правильный ли ответ или нет. Вы также можете использовать 
введенный текст с командой
<a href="../Rec/UN.htm#N">UN:N</a> для поиска, например, артефакта с введенным 
именем, или монстра, постройки замка или имени навыка. <a href="../Rec/IF.htm#D">
IF:D</a> 
используется для установки окна ввода текста.</p>
<p><b id="step">5. Текст заголовка:</b> текст вверху диалогового окна (белый) можно 
установить командой <a href="../Rec/IF.htm#D">IF:D</a>, и жёлтый текст для 
чекбоксов может быть использован, даже если вы не использовали чекбоксы в диалоге.</p>
<p><b id="step">6. Кнопка отмены:</b> команда <a href="../Rec/IF.htm#F">IF:F</a> может 
быть использованна для отключения или включения кнопки &quot;Отмена&quot; (и клавишей <span class="key">Esc</span> на 
клавиатуре) для расширенного многозадачного диалогового окна.</p>
<u>Пример 2</u>:
<script type="erm">!#IF:F1/z21/z22/z23/z24/0; - установить подсказки и отключить кнопку отмены.</script><br>
<u>Пример 3</u>:
<script type="erm">!#VRz199:S^..\Data\Zvs\Cmp.res^;
!#VRz10:S^Время играть!^;
!#VRz11:S^Ваше имя^;
!#VRz12:S^Выберите ваше заклинание^;
!#VRz13:S^%Z199\21_001.BMP^;
!#VRz14:S^%Z199\21_002.BMP^;
!#VRz15:S^%Z199\21_003.BMP^;
!#VRz16:S^%Z199\21_004.BMP^;
!#VRz17:S^Жажда крови^;
!#VRz18:S^Благословение^;
!#VRz19:S^Волшебная стрела^;
!#VRz20:S^Медлительность^;
!#VRz21:S^Ваш герой начнёт с заклинанием Жажда крови^;
!#VRz22:S^Ваш герой начнёт с заклинанием Благословение^;
!#VRz23:S^Ваш герой начнёт с заклинанием Волшебная стрела^;
!#VRz24:S^Ваш героя начнёт с заклинанием Медлительность^;
!#IF:D1/z10/z11/z12/z13/z14/z15/z16/z17/z18/z19/z20/z17/z18/z19/z20;
!#IF:F1/z21/z22/z23/z24/0; - установить подсказки и отменить кнопку отмены
!#IF:E100/1; - записать выбор диалога номер 1 в v100
!#VRz400:Sz1; - ваше имя
!#VRz400:H10; - Проверить, если строка осталась пустой, во флаг 10
!#VRz400&-10:S^DracoL1ch^; - если строка пуста, установить имя на DracoL1ch</script>
И вот что вы увидите в итоге:
<p align="center"><img src="../Img/if/IFDm.jpg" width="432" height="336"></p>
<h3>Использование расширенных диалоговых окон #2 - диалог одиночного изображения/анимации</h3>
<p>Если вы хотите показать одиночное изображение или одиночный AVI-файл, вы можете 
использовать второй тип расширенных диалогов. Эти диалоги более просты для 
установки, чем многозадачные (меньше параметров), и имеют преимущество в том, 
что могут показывать изображение или видео почти любого размера. Главный 
недостаток - вы не можете включить никакой текст вместе с изображением или 
видео. Когда вы вызываете этот диалог, вы получаете простое окно сообщение с 
изображением или AVI в центре и кнопку ОК ниже. Команда для установки этого 
сообщения - <a href="../Rec/IF.htm#B">IF:B</a>, и команда для показа - <a href="../Rec/IF.htm#P">
IF:P</a>.<br>
<u>Пример</u>:
<script type="erm">!!VRz1:S^..\Data\Chaos.gif^;
!!IF:B99/1/0;
!!IF:P99;</script>
<p align="center"><img src="../Img/if/IFB.jpg" width="181" height="266"></p><br>
Но некоторое перекрывание командой <a href="../Rec/IF.htm#D">IF:D</a> 
(используется для установки многозадачного диалога) - если вы используете 
команду <a href="../Rec/IF.htm#D">IF:D</a> 
вместо <a href="../Rec/IF.htm#B">IF:B</a>, первая картинка или AVI в таблице 
параметров будет показано командой <a href="../Rec/IF.htm#P">IF:P</a>, а 
дополнительные картинки или анимации будут проигнорированы.</p>
<h3>Расширенный диалог #3: радио- или чекбокс-диалог (до 12 опций)</h3>
<u>Пример</u>:
<script type="erm">!#VRz1:S^Отметьте правила для этой игры - на ваш выбор (страница 1 из 2).^;
!#VRz2:S^Атака без контрудара вместо полёта^;
!#VRz3:S^Инвертированная скорость существ^;
!#VRz4:S^Половинная стоимость существ на 7ой день^;
!#VRz5:S^Создание героями магического ландшафта^;
!#VRz6:S^Двойная атака для всех существ^;
!#VRz7:S^Растущие армии^;
!#VRz8:S^Продажа кабанов во всех внешних жилищах^;
!#VRz9:S^Начало с героями пятого уровня^;
!#VRz10:S^Дублирование артефактов^;
!#VRz11:S^Туман войны^;
!#IF:G0/100/4/1/2/3/4/5/6/7/8/9/10/11/0/0;</script>
Вот так будет выглядеть диалог с использованием команды <a href="../Rec/IF.htm#G">IF:G</a>
<p align="center"><img src="../Img/if/IFG.jpg" width="401" height="336"></p>



<script src="../erm.js"></script></body></html>